<!-- Menu toggle button -->

<a href="" class="dropdown-toggle" data-toggle="dropdown">
  <i class="fa fa-bell"></i>
  <span ng-show="!zeroNotif" class="label label-warning">{{notifs.length}}</span>
</a>

<ul class="dropdown-menu animated-dropdown-menu outerMenu" ng-class="bckColor">
  <li ng-show="!oneNotif" class="header">You have {{notifs.length}} new notifications</li>
  <li ng-show="oneNotif" class="header">You have 1 new notification</li>

    <!-- Inner Menu: contains the notifications -->
    <ul class="menu">

      <!-- Unread notifications -->

      <li ng-repeat="notif in notifs" ng-show="notif.isUnread">

        <span class="ciara" ng-class="bckColor"></span>

        <div class="row" ng-click="changeIsUnread(notif._id)">

          <!-- Avatar -->
          <div class="notification-avatar">
            <a ng-show="notif.type === 1" ui-sref="root.main.registrationProfile.regAdmin({registrationId: notif.sentByReg._id})">
              <img ng-src="./img/icons/data_request.png" alt="Registration Request"/>
            </a>
            <a ng-show="[11, 12].lastIndexOf(notif.type) !== -1" ui-sref="root.main.deviceProfile.whoSee({deviceId: notif.itemId._id})">
             <img ng-src="{{notif.itemId.avatar}}" alt="Device Avatar">
            </a>
            <a ng-show="[22, 23, 24].lastIndexOf(notif.type) !== -1">
             <img ng-src="./img/org_avatar 14.46.39.png" alt="Contract Avatar">
            </a>
            <a ng-show="[31, 32, 33, 34, 35].lastIndexOf(notif.type) !== -1" ui-sref="root.main.companyProfile.devices({companyAccountId: notif.sentBy._id})">
              <img ng-src="{{notif.sentBy.avatar}}" alt="Company Avatar">
            </a>
            <a ng-show="notif.type === 13">
              <img ng-src="./img/icons/data_request.png" alt="Company Avatar"/>
            </a>
            <a ng-show="notif.type === 21" ui-sref="root.main.userProfile.contracts({companyAccountId: notif.addressedTo[0]._id, userAccountId: notif.userId})">
              <img ng-src="./img/org_avatar 14.46.39.png" alt="Contract Avatar"/>
            </a>
          </div>

          <!-- Descriptions -->
            <p ng-show="notif.type === 1">You have received a registration request from:<a ui-sref="root.main.registrationProfile.regAdmin({registrationId: notif.sentByReg._id})">{{notif.sentByReg.companyName}}</a></p>
            <p ng-show="notif.type === 11">A device has been activated:  <a ng-click="changeIsUnreadToFalse(notif._id)" ui-sref="root.main.deviceProfile.whoSee({deviceId: notif.deviceId._id})">{{notif.itemId.name}}</a>.</p>
            <p ng-show="notif.type === 12">A device has been deactivated:  <a ng-click="changeIsUnreadToFalse(notif._id)" ui-sref="root.main.deviceProfile.whoSee({deviceId: notif.deviceId._id})">{{notif.itemId.name}}</a>.</p>
            <p ng-show="notif.type === 13">You have discovered new device(s) </p>
            <p ng-show="notif.type === 21">You have a <a  ui-sref="root.main.userProfile.contracts({companyAccountId: notif.addressedTo[0]._id, userAccountId: notif.userId})">contract</a> request from <a  ui-sref="root.main.companyProfile.devices({companyAccountId: notif.sentBy._id})">{{notif.sentBy.name}}</a>.</p>
            <p ng-show="notif.type === 22">A <a ui-sref="root.main.userProfile.contracts({companyAccountId: notif.addressedTo[0]._id, userAccountId: notif.userId})">contract</a> has been modified.</p>
            <p ng-show="notif.type === 23">A contract has been cancelled.</p>
            <p ng-show="notif.type === 24">A contract has been approved.</p>
            <p ng-show="notif.type === 31">You have a partnership request from <a  ui-sref="root.main.companyProfile.devices({companyAccountId: notif.sentBy._id})">{{notif.sentBy.name}}</a>.</p>
            <p ng-show="notif.type === 32">The partnership between <b>{{notif.addressedTo[0].name}}</b> and <b>{{notif.addressedTo[1].name}}</b> was cancelled by <a  ui-sref="root.main.companyProfile.devices({companyAccountId: notif.sentBy._id})">{{notif.sentBy.name}}</a>.</p>
            <p ng-show="notif.type === 33">Your partnership with <a  ui-sref="root.main.companyProfile.devices({companyAccountId: notif.sentBy._id})">{{notif.sentBy.name}}</a> was rejected.</p>
            <p ng-show="notif.type === 34">Your partnership with <a  ui-sref="root.main.companyProfile.devices({companyAccountId: notif.sentBy._id})">{{notif.sentBy.name}}</a> was accepted.</p>
            <p ng-show="notif.type === 35">You have requested a partnership with <a  ui-sref="root.main.companyProfile.devices({companyAccountId: notif.sentBy._id})">{{notif.sentBy.name}}</a>.</p>
        </div>

        <!-- Actions -->
        <div class="notification-actions">
          <button  ng-show="notif.type === 1" ng-click="acceptRegistration(notif.sentByReg._id, notif._id)" type="button" class="btn btn-default btn-xs">Approve</button>
          <button  ng-show="notif.type === 1" ng-click="rejectRegistration(notif.sentByReg._id, notif._id)" type="button" class="btn btn-default btn-xs">Reject</button>

          <!-- <button ng-show="notif.type === 21" ng-click="acceptDataRequest(notif.itemId._id, notif._id)" type="button" class="btn btn-default btn-xs">Approve</button>
          <button ng-show="notif.type === 21" ng-click="rejectDataRequest(notif.itemId._id, notif._id)" type="button" class="btn btn-default btn-xs">Reject</button> -->

          <button  ng-show="notif.type === 31" ng-click="acceptNeighbourRequest(notif._id, notif.sentBy._id)" type="button" class="btn btn-default btn-xs">Accept</button>
          <button  ng-show="notif.type === 31" ng-click="rejectNeighbourRequest(notif._id, notif.sentBy._id)" type="button" class="btn btn-default btn-xs">Decline</button>
        </div>

      </li>


<!-- Read notifications -->

      <li ng-repeat="notif in notifs" ng-show="[1, 21, 31].indexOf(notif.type) !== -1 && (notif.status== 'waiting') && !(notif.isUnread)">

        <span class="ciara" ng-class="bckColor"></span>

        <div class="row readNot">
        <!-- Avatar -->
        <div class="notification-avatar" ng-click="changeIsUnread(notif._id)">
          <a ng-show="notif.type === 1" ui-sref="root.main.registrationProfile.regAdmin({registrationId: notif.sentByReg._id})">
            <img ng-src="../../../../img/icons/data_request.png" alt="Company Avatar"/>
          </a>
          <a ng-show="notif.type === 21" ui-sref="root.main.deviceProfile.whoSee({deviceId: notif.itemId._id})">
           <img ng-src="{{notif.itemId.avatar}}" alt="Device Avatar">
          </a>
          <a ng-show="notif.type === 31" ui-sref="root.main.companyProfile.devices({companyAccountId: notif.sentBy._id})">
            <img ng-src="{{notif.sentBy.avatar}}" alt="Company Avatar">
          </a>
        </div>

        <!-- Description -->
          <p ng-show="notif.type === 1"> You have received a registration request from: </p><a ui-sref="root.main.registrationProfile.regAdmin({registrationId: notif.sentByReg._id})"><p> {{notif.sentByReg.companyName}} </p></a>
          <p ng-show="notif.type === 21">You have a <a  ui-sref="root.main.userProfile.contracts({companyAccountId: notif.addressedTo[0]._id, userAccountId: notif.userId})">contract</a> request from <a  ui-sref="root.main.companyProfile.devices({companyAccountId: notif.sentBy._id})">{{notif.sentBy.name}}</a>.</p>
          <p ng-show="notif.type === 31">You have partnership request from <a  ui-sref="root.main.companyProfile.devices({companyAccountId: notif.sentBy._id})">{{notif.sentBy.organisation}}</a>.</p>
        </div>

        <!-- Actions -->
        <div class="notification-actions readNot">

          <button  ng-show="notif.type === 1" ng-click="acceptRegistration(notif.sentByReg._id, notif._id)" type="button" class="btn btn-default btn-xs">Approve</button>
          <button  ng-show="notif.type === 1" ng-click="rejectRegistration(notif.sentByReg._id, notif._id)" type="button" class="btn btn-default btn-xs">Reject</button>

          <!-- <button ng-show="notif.type === 21" ng-click="acceptDataRequest(notif.itemId._id, notif._id)" type="button" class="btn btn-default btn-xs">Approve</button>
          <button ng-show="notif.type === 21" ng-click="rejectDataRequest(notif.itemId._id, notif._id)" type="button" class="btn btn-default btn-xs">Reject</button> -->

          <button  ng-show="notif.type === 31" ng-click="acceptNeighbourRequest(notif._id, notif.sentBy._id)" type="button" class="btn btn-default btn-xs">Accept</button>
          <button  ng-show="notif.type === 31" ng-click="rejectNeighbourRequest(notif._id, notif.sentBy._id)" type="button" class="btn btn-default btn-xs">Decline</button>

        </div>

      </li>
      <!-- end notification -->
    </ul>

    <li class="footNotif" ng-class="bckColor"><a ng-click="seeAll()"><b>View all</b></a></li>

</ul>
